#:import VucanView vulcanview
#:import Calendar calendar.Calendar
<RoundedNormalButton>:
    background_color: 0,0,0,0  # the last zero is the critical on, make invisible
    bacground_normal: ''
    canvas.before:
        Color:
            rgba: (0.482, 0.380, 1.0, 1) if self.state=='normal' else (0,.7,.7,1)
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [20,]

<DatePicker>:
    title: 'Selecciona una fecha'
    size_hint: None, None
    size: '400dp', '500dp'
    auto_dismiss: False

    BoxLayout:
        orientation: 'vertical'

        BoxLayout:
            size_hint_y: None
            height: '50dp'

            Button:
                text: "<"
                on_press: root.prev_month()

            Label:
                text: root.display_month_year
                size_hint_x: 2

            Button:
                text: ">"
                on_press: root.next_month()

        GridLayout:
            id: calendar_container
            cols: 7
            spacing: '5dp'
            padding: '5dp'

        Button:
            size_hint_y: None
            height: '40dp'
            text: 'Cancelar'
            on_press: root.dismiss()

<WidgetCamera>:
    orientation: 'horizontal'
    padding: 10
    spacing: 10

    RoundedNormalButton:
        text: root.button_text
        size_hint_y: None
        height: '40dp'
        on_press: root.capture_photo()
    Image:
        id: camera_image
        size_hint_y: None
        height: 300
        allow_stretch: True
        # Muestra un texto si no hay imagen
        source: self.texture if root.image_texture else ''
        opacity: 1 if root.image_texture else 0  # Hacerla invisible si no hay imagen

    Label:
        id: no_photo_label
        text: "Foto no seleccionada" if not root.image_texture else ''
        color: (1, 0, 0, 1)  # Color rojo
        size_hint_y: None
        height: self.texture_size[1] if not root.image_texture else 0  # Ocupa espacio solo si no hay foto

<CustomTextInput>:
    input_field: input_field
    password: False  # Propiedad para controlar si es un campo de contraseña
    text: ''  # Propiedad vinculada al texto del TextInput interno
    max_chars: 0  # Sin límite de caracteres por defecto
    input_type: 'text'  # Tipo de entrada por defecto es alfanumérico
    max_decimals: 2  # Máximo de decimales si es numérico
    error_message: ''  # Mensaje de error
    required: False  # Si el campo es obligatorio o no
    canvas.before:
        Color:
            rgba: root.line_color
        Line:
            width: root.line_width
            points: [self.x + dp(10), self.y, self.x + self.width - dp(10), self.y]
    TextInput:
        id: input_field
        hint_text: root.hint_text
        hint_text_color: (0.7, 0.7, 0.7, 1)
        foreground_color: (0, 0, 0, 1)
        background_color: (1, 1, 1, 0)
        password: root.password  # Activa el modo contraseña
        size_hint_x: None
        width: self.parent.width - dp(20)
        size_hint_y: None
        height: '40dp'
        font_size: '18sp'
        pos_hint: {'center_x': 0.5, 'center_y': 0.2}
        multiline: False
        padding: [10, 10, 10, 10]
        on_focus: root.update_line(self.focus)
        on_text: root.on_textinput_text(self, self.text)
        on_text_validate: root.validate_text(self, self.text)
        valign: 'bottom'

    Label:
        id: error_label
        text: root.error_message
        color: (1, 0, 0, 1)  # Color rojo para el mensaje de error
        font_size: '14sp'
        size_hint_y: None
        height: self.texture_size[1] if root.error_message else 0  # Ocupa espacio solo si hay error
        pos_hint: {'x': 0.05, 'top': 0.9}


            
<Inicio>
    BoxLayout:
        id: boxInicio
        canvas.before:
            Color:
                rgba: 1,1,1,.5
            Rectangle:
                source: 'image/home.jpg'
                pos: self.pos
                size: self.size

        orientation: 'vertical'
        BoxLayout:
            Image: 
                source: 'image/logo.jpeg'
        BoxLayout:
        BoxLayout:
            orientation: 'vertical'
            BoxLayout:
            BoxLayout:
                orientation: 'horizontal'
                BoxLayout:
                    size_hint: .1,1
                BoxLayout:
                    size_hint: .8,1
                    RoundedNormalButton: 
                        text: 'Inicio'
                        on_release: root.go_login()

                BoxLayout:
                    size_hint: .1,1
            BoxLayout:
        

<Login>
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            canvas.before:
                Color:
                    rgba: 1,1,1,.5
                Rectangle:
                    source: 'image/home.jpg'
                    pos: self.pos
                    size: self.size
            size_hint: 1,.4
            Image: 
                source: 'image/logo.jpeg'
        BoxLayout:
            size_hint: 1, .6
            orientation: 'horizontal'
            BoxLayout:
                size_hint: .1,1
            BoxLayout:
                canvas.before:
                    Color:
                        rgba: (1, 1, 1, 1) 
                    RoundedRectangle:
                        pos: (self.x, self.y)
                        size: (self.width, self.height + 40)
                        radius: [20,]

                size_hint: .8,1
                BoxLayout:
                    orientation: 'vertical'
                    Label: 
                        color: 0,0,0,1
                        text: 'Bem-vindo'
                    CustomTextInput: 
                        id: txtUsuario
                        hint_text: 'Usuario'
                        multiline: False
                        write_tab: False
                        text: 'mant'
                    CustomTextInput:
                        id:txtPassword
                        hint_text: 'Password'
                        write_tab: False
                        multiline: False
                        password: True
                        text: 'Pinamar2024'
                    RoundedNormalButton:
                        text: 'Inicio'
                        on_release: root.validar_usuario()
                    Label:
                        color: 0,0,0,1
                        text: 'Esqueceu sua senhia?'
            BoxLayout:
                size_hint: .1,1

<Principal>
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            size_hint: 1, .15
            canvas.before:
                Color:
                    rgba: (0.1, 0.1, 0.1, 1)
                Rectangle:
                    pos: self.pos
                    size: self.size      
            orientation: 'horizontal'
            BoxLayout:
                size_hint: 0.2, 1
                Image:
                    source: 'image/logo_chico.png'
                    allow_stretch: True
                    keep_ratio: True
                    pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            BoxLayout:
                size_hint: 0.6, 1  

            BoxLayout:
                orientation: 'vertical'
                size_hint: 0.2, 1
                canvas.before:
                    Color:
                        rgba: (0.1, 0.1, 0.1, 1)  
                    Rectangle:
                        pos: self.pos
                        size: self.size
                BoxLayout:
                    orientation: 'horizontal'
                    padding: [20, 10, 20, 10]
                    spacing: 10
                    Label:
                        text: 'Sair'
                        font_size: 20
                        color: (1, 1, 1, 1)
                        size_hint_x: 1
                        halign: 'left'  
                        valign: 'middle'  
                        text_size: self.size  
                    Image:
                        source: 'image/salir.png'
                        size_hint: None, None
                        size: 50, 50
                        allow_stretch: True  
                Label:
                    text: 'Juan Gomez'
                    font_size: 14
                    color: (1, 1, 1, 1)
                    size_hint_y: None
                    height: self.texture_size[1]
                    minimum_height: 30                
         
        BoxLayout:
            size_hint: 1, .25  
            canvas.before:
                Color:
                    rgba: 236,230,240,1
                Rectangle:
                    pos: self.pos
                    size: self.size      
            orientation: 'horizontal'
            padding: 20  
            spacing: 20 
            
            # Parte 1
            BoxLayout:
                size_hint: 0.3, 1  
                orientation: 'vertical'
                padding: 10  
                
                canvas.before:
                    Color:
                        rgba: 0.5, 0.5, 0.5, 0.5  # sombra                   
                    RoundedRectangle:
                        pos: (self.x + 5, self.y - 5)  # desplazar de la sombra
                        size: self.size
                        radius: [20]
                
                canvas.before:
                    Color:
                        rgba: 0.9, 0.9, 1, 1 
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [20]
                
                Image:
                    source: 'image/inst.png'
                    allow_stretch: True
                    keep_ratio: True
                    pos_hint: {'center_x': 0.5, 'center_y': 0.6}
                Label:
                    color: 0,0,0,1
                    text: 'Check in'

            # Parte 2
            BoxLayout:
                size_hint: 0.3, 1
                orientation: 'vertical'
                padding: 10  
                
                canvas.before:
                    Color:
                        rgba: 0.5, 0.5, 0.5, 0.5                      
                    RoundedRectangle:
                        pos: (self.x + 5, self.y - 5)  
                        size: self.size
                        radius: [20]
                
                canvas.before:
                    Color:
                        rgba: 0.9, 0.9, 1, 1  
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [20]
                
                Image:
                    source: 'image/mant.png'
                    allow_stretch: True
                    keep_ratio: True
                    pos_hint: {'center_x': 0.5, 'center_y': 0.6}
                Label:
                    color: 0,0,0,1
                    text: 'Manutenção'

            # Parte 3
            BoxLayout:
                size_hint: 0.3, 1
                orientation: 'vertical'
                padding: 10  
                
                canvas.before:
                    Color:
                        rgba: 0.5, 0.5, 0.5, 0.5  
                    # Dibuja la sombra ligeramente desplazada
                    RoundedRectangle:
                        pos: (self.x + 5, self.y - 5)  # Desplazamiento de la sombra
                        size: self.size
                        radius: [20]
                
                canvas.before:
                    Color:
                        rgba: 0.9, 0.9, 1, 1  # Color del botón
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [20]
                
                Image:
                    source: 'image/desinst.png'
                    allow_stretch: True
                    keep_ratio: True
                    pos_hint: {'center_x': 0.5, 'center_y': 0.6}
                Label:
                    color: 0,0,0,1
                    text: 'Desinstalação'
        VulcanView:
            id:vv
            size_hint: 1,1
            title_background_color: .47,.47,.47,1
            title_text_color: 1,1,1,1
            background_color: 1,1,1,1
            text_color: 0,0,0,1
            row_selection: True
            on_selection: root.go_mant()
            cols_size_hint: {'0':.2, '1':.6, '2':.2 }
            

        
                   
<Mantenimiento>
    BoxLayout:
        orientation: 'vertical'
        padding: 10
        spacing: 10
        BoxLayout:
            size_hint: 1, .15
            canvas.before:
                Color:
                    rgba: (0.1, 0.1, 0.1, 1)
                Rectangle:
                    pos: self.pos
                    size: self.size      
            orientation: 'horizontal'
            BoxLayout:
                size_hint: 0.2, 1
                Image:
                    source: 'image/logo_chico.png'
                    allow_stretch: True
                    keep_ratio: True
                    pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            BoxLayout:
                size_hint: 0.6, 1  

            BoxLayout:
                orientation: 'vertical'
                size_hint: 0.2, 1
                canvas.before:
                    Color:
                        rgba: (0.1, 0.1, 0.1, 1)  
                    Rectangle:
                        pos: self.pos
                        size: self.size
                BoxLayout:
                    orientation: 'horizontal'
                    padding: [20, 10, 20, 10]
                    spacing: 10
                    Label:
                        text: 'Sair'
                        font_size: 20
                        color: (1, 1, 1, 1)
                        size_hint_x: 1
                        halign: 'left'  
                        valign: 'middle'  
                        text_size: self.size  
                    Image:
                        source: 'image/salir.png'
                        size_hint: None, None
                        size: 50, 50
                        allow_stretch: True  
                Label:
                    text: 'Juan Gomez'
                    font_size: 14
                    color: (1, 1, 1, 1)
                    size_hint_y: None
                    height: self.texture_size[1]
                    minimum_height: 30                
         
        BoxLayout:
            size_hint: 1, .25  
            canvas.before:
                Color:
                    rgba: 236,230,240,1
                Rectangle:
                    pos: self.pos
                    size: self.size      
            orientation: 'horizontal'
            padding: 20  
            spacing: 20 
            Label:
                text: 'datos del mantenimiento'
            
        BoxLayout:
            size_hint: 1, .6
            orientation: 'horizontal'
            BoxLayout:
                size_hint: .1,1
            BoxLayout:
                canvas.before:
                    Color:
                        rgba: (1, 1, 1, 1) 
                    RoundedRectangle:
                        pos: (self.x, self.y)
                        size: (self.width, self.height)
                        radius: [20,]

                size_hint: .8,1
                orientation: 'vertical'
                padding: 10
                BoxLayout:
                    orientation: 'vertical'
                    BoxLayout:
                        size_hint: 1,.8
                        orientation: 'vertical'
                        orientation: 'vertical'
                        CustomTextInput: 
                            id: txtFecha
                            hint_text: 'Fecha'
                            input_type: 'date'
                        WidgetCamera:
                        WidgetCamera:
                        CustomTextInput:
                            id:txtObs
                            hint_text: 'Observacoes'
                            input_type: 'note'
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint:1,.2
                        BoxLayout: 
                        BoxLayout: 
                            spacing: 10
                            padding: 10
                            orientation: 'vertical'
                            RoundedNormalButton:
                                text: 'Enviar'
                            RoundedNormalButton:
                                text: 'Cancelar'
                        BoxLayout: 
            BoxLayout:
                size_hint: .1,1

